root_dir = "/global/cfs/cdirs/m3346/shlufl/Ce3Mn8/new_molecule/toluate/U_0.80/"

incar = """
SYSTEM = vasp

#### sym ####
#ISYM = 0

#### system size ####
#NBANDS = 448
#NELECT = 383.0

#### accuracy ####
PREC = Accurate
ENCUT = 500
LREAL = F

#### parallelization ####
#KPAR = 4
NCORE = 16

#### electronic optimization ####
EDIFF = 1E-5
NELM = 120
#NELMIN = 10
NELMDL = -9
AMIX = 0.2
AMIX_MAG = 0.4
AMIX_MIN = 0.05
BMIX = 0.0001
BMIX_MAG = 0.0001
ALGO = Normal

#### structural relaxation ####
#NSW = 500
#IBRION = 2
#ISIF = 2
#EDIFFG = -0.02
#POTIM = 0.3

#### magnetism: accuracy ####
LASPH = T
GGA_COMPAT = F

#### magnetism: collinear spin ####
#ISPIN = 2
#MAGMOM = 3.0 3.0 3.0 1000*0.0
#NUPDOWN = 9

#### magnetism: noncollinear spin, SOC ####
LSORBIT = T
SAXIS = 0 0 1
MAGMOM = 0.0 0.0 0.0 \\
         0.0 0.0 1.0 \\
         0.0 0.0 1.0 \\
         {mstring:s}

#### magnetism: constraint ####
I_CONSTRAINED_M = 1
M_CONSTR = 0.0 0.0 0.0 \\
         0.0 0.0 1.0 \\
         0.0 0.0 1.0 \\
         {mstring:s}
LAMBDA =  10.0
RWIGS = 1.323 1.323 0.741 0.820 0.863 0.370


#### magnetism: orbital moment ####
LORBMOM = T

#### charge, wavefunction ####
ISTART = 0
ICHARG = 1
LWAVE = F
LCHARG = T
LAECHG = F
LMAXMIX = 6

#### dos ####
ISMEAR = 0
SIGMA = 0.01
#NEDOS = 301
#EMIN = -15
#EMAX = 10
LORBIT = 10

#### Partial Charge ####
#LPARD = T
#EINT = -5.0000  -4.7355
#EINT = -4.7355 -4.0500

#### vdW ####
#IVDW = 11

#### LDA+U ####
LDAU = T
LDAUTYPE = 2
LDAUPRINT = 1
LDAUL =   3    2    -1   -1   -1   -1
LDAUU =   2.0  0.8  0.0  0.0  0.0  0.0
LDAUJ =   0.0  0.0  0.0  0.0  0.0  0.0

#### HSE ####
#LHFCALC = T 
#HFSCREEN = 0.2 
#PRECFOCK = Accurate
#ALGO = All 
#TIME = 0.35

#### wann ####
#LWANNIER90 = .T.
#LWRITE_UNK = .TRUE.

### polarization ###
#IDIPOL = 4
#LMONO = T
#LDIPOL = T
#LCALCPOL = T
#DIPOL = 0.5 0.5 0.5 

### occupation matrix control ###
#OCCEXT = 1
"""

kpoints = """kpoints
0
gamma
 1   1   1
 0.0 0.0 0.0
"""

poscar = """Ce Mn  N  O  C  H 
 1.0000000000000000
    34.0421612755524947    0.0000000000000000    0.0000000000000000
     0.0000000000000000   28.3358204934858016    0.0000000000000000
     0.0000000000000000    0.0000000000000000   31.2910668764410076
 Ce  Mn  N   O   C   H  
   3   8   1  46 154 137
Cartesian
 15.8896287995113354 14.0930373290329491 15.8311346260827577
 11.8864290241396766 14.0634676887035397 15.8309064154620494
 19.9049342510230503 14.0634676887035397 15.8309064154620494
 17.6332151290462349 15.6012071590402979 18.2413254800452833
 14.1629838209337890 12.5752152574390550 18.2673987473100397
 17.6205518092444890 12.5911438278338537 13.3811760521484455
 17.4565901875726404 12.4411521958944391 18.2962991200983112
 14.3089148798028241 12.5500858938036721 13.3089632005127836
 14.2973766473933956 15.7511173559838777 18.2914207491373908
 14.1830342921795971 15.7052406508715929 13.4528571294302779
 17.4950411109370485 15.7492327704081578 13.3825329122371315
  9.1675229032209504 14.0457541993392283 15.8004537922379313
 15.9601618031601742 15.6714110009149206 17.4336794926921428
 13.8505673090216668 14.1992149554020060 17.2847373876189678
 15.8087839427232364 12.4909732863962510 17.4048661483048477
 15.9543762749589249 12.5496951467747486 14.2046133014326124
 15.8592782547666520 15.7188770615755686 14.2798958356747683
 13.8601750174848011 14.0435278575907923 14.4002658402349013
 17.9513311441045005 14.2132474783639395 14.3971378812008624
 17.9310697332900126 13.9671433808361947 17.2545775250577300
 19.2675312936987275 12.4832977394553204 12.3641117501742297
 20.9023880435001175 15.1438735980321777 17.8403338039050539
 19.2692388895945435 15.6561915416714594 19.2812011503525795
 16.7801326085065909 11.1492961689944927 19.6133976475412553
 14.5856599898570227 10.9469551239897775 19.2602726445044965
 19.1725710460948306 12.2742140882501509 19.1955919294355084
 12.5995336368250097 12.4504082323129026 12.3813294432700047
 18.6468245420039977 16.3650304805487288 16.4367441505155654
 18.0885460013920181 17.4292302548821603 14.5564230960286380
 14.8122535083368021 14.2997578678106336 11.8048705212918090
 17.0219330456129434 14.0629129862760003 11.7804338743260040
 17.0054259761119830 14.0964815859555053 19.8088177012265376
 14.7890465444705033 13.9609874498181057 19.9218501700042090
 14.6303644424470374 17.3910317734451567 12.5725839152473959
 16.7844129547236030 17.0164319175752681 12.0564149555448843
 13.1553477868206787 11.7988626651552195 16.4305861174895789
 14.9888254438986994 11.3220238020810626 11.9336767303485800
 17.1557751890792680 10.9695724754231207 12.3969235198171255
 15.0147988193075932 16.9983932133785025 19.6547434585086620
 17.2116367343314032 17.2270532313079592 19.2347208020014975
 12.5354483308498814 15.8218231598586794 12.4160073934484867
 10.9817013661061225 15.2168589008571704 13.8920814227198210
 12.4919202137277772 12.5031405990194706 19.2688856083877766
 13.1836726904561505 16.4627599331967716 15.2424463437720199
 13.7657917145923054 17.4284438210244943 17.1501555040995832
 11.3161558609803983 15.8357142336968106 17.3959221019277592
 12.5949041187049069 15.8985865085444527 19.2274171265887617
 20.5521363805939110 15.8772631900007113 14.2469331259324914
 19.2120746859834739 15.8917161414774064 12.4632405706650733
 18.6472103475660660 11.8173221584033925 15.2063699740732510
 10.8810268132571046 12.9583348027268670 17.8048351327797008
 11.2860366311660538 12.3454075011036757 14.1860633517283912
 22.4858936076608842 14.0890127846981770 15.8035023372936809
 20.8701301000401820 13.0136071337970805 13.8113244959651951
 20.5833958249643700 12.2998696322381562 17.4583760134065358
 18.0668357274955333 10.7781978078785059 17.0872687945564863
 13.7444566621233673 10.8854225793373516 14.4762041755154289
 23.2404815395736932 15.6875697169278894 14.7960765350348318
 20.4941859181214170 15.5106505400168366 18.9555675246034099
 21.4839487186683122 15.6953614835754145 20.0558464280857365
 21.3575723012634100 16.7283417819125511 21.0078540020956339
 22.3693451353405344 16.8242297434016521 21.9742415719888022
 20.2372397572568694 17.7496525846568609 20.9969146639708839
 15.6796879734147101 10.5504339138689822 19.7454937681523077
 18.4601788617018485 17.4262627934876448 15.7535808498488290
 18.7853857346054589 18.7183849483751175 16.4162360400120093
 17.7948435173736392 19.7718927264268203 16.2658644773379528
 18.4536693579770130 21.1179647091346574 16.6574830228733326
 19.6022473477946590 21.1745387554856279 17.4545467222894679
 20.3619553400771238 20.0333015438513584 17.6205470435613840
 19.9335765703678085 18.8086840599544409 17.0860309181831838
 16.5206058267920817 19.6081278806555730 15.4912457360542781
 15.9129209614406957 14.2097907361933089 11.1821036554099322
 15.8771599378640555 14.2504634524615277  9.6900596736553339
 17.0495922446729438 14.2930839240843639  8.9002406248552717
 14.6170444598313374 14.2460104215163632  9.0869216022663917
 18.4160766813495300 14.3733173170455100  9.4153292161904041
 15.9129092634344786 14.2097907361933125 20.4445464738440172
 15.9969599549699097 14.7108684566954810 21.8436564022891559
 14.9104386267095439 14.6701691485409533 22.7420754791820485
 15.1527892147688750 15.1623757541924675 24.0383582021666271
 16.3621032641290434 15.6945312040459459 24.4055285548223893
 17.4131633152951828 15.7687192839391077 23.5151082450397553
 17.2238917709542569 15.2635544704433919 22.2466442922186118
 13.5697870535908081 14.1455407035538911 22.3854104593010490
 15.7442587750157514 17.7352539296134211 12.0681703354072294
 15.8060187260547167 19.0721774165327425 11.3985942051717277
 16.9102182412423332 19.4871429066594004 10.6543007003328274
 16.8376497216467982 20.7186410818401789 10.0081666200893196
 15.7468944772442843 21.5063199329919499 10.0928530202999909
 14.6708023684114544 21.1011915360109334 10.8548446673987691
 14.7003791347694630 19.8757758995896978 11.4827509452294194
 18.1931763082017177 18.7064560454241224 10.5512268058616545
 16.0556914788780176 10.6559008611799655 11.8363010027221200
 16.0479933258258676  9.4405848629388771 10.9798421591710422
 16.1009857536531165 17.6216874665799068 19.7207117196436670
 16.1074624608613206 18.8956089060631527 20.4797614342392791
 15.0735378036685290 19.2195849913422592 21.4210686955030987
 15.3532138534641156 20.5076231492815495 22.0835239931127560
 16.4123977569641788 21.3319019986777292 21.7341077728217158
 17.3551562577088667 20.9669882389225819 20.7961168547206938
 17.2194351378254034 19.7230922887077398 20.2165892285917153
 13.9501132353454267 18.4044075686770512 21.7520023333838033
 11.3246549518136241 15.6707360454992664 12.7906691299715973
 10.2442163867244389 16.0227960069185258 11.8167692651782517
 10.4149345925921022 16.8613577380450934 10.7217196267264878
  9.3029830031226588 17.0690178706041884  9.8815416818773496
  8.0903549131137567 16.4909873535402021 10.1432442302850792
  8.9878533769995457 15.4498156371488200 12.0825591248956137
 11.7041826606181303 17.5195881300633687 10.3709155240956648
 13.2718352439530154 17.4733874862119194 16.0038831908798613
 12.4793943311296989 18.6739274389815151 15.5659178869085100
 12.4348530443975314 19.7826249842702993 16.4463747607762052
 11.5899854267536462 20.8357597370758292 16.0635587954247328
 10.9330562073812452 20.8917493798716620 14.9032940007578585
 11.0273758902264181 19.8297332831898778 14.0187267603166461
 11.7926071338918845 18.7024022371810190 14.3393659552192219
 13.1548473425724737 19.8478786651757630 17.7776450439470821
 11.4696266581292434 16.0123229784390020 18.6227592346479440
 10.2867871166412286 16.3598838501885666 19.4544888173796728
  9.1596801330880400 16.9936144609946922 18.9121245841314511
  8.0652664934180827 17.1837170469010445 19.7777401365258569
  8.0743024986624370 16.7272423568171291 21.0735638141753370
  9.1747757655665438 16.1087424953289684 21.5842365453501337
 10.2826208871656899 15.9426243265514742 20.7852171447903054
  9.0904704506330809 17.5258544910565384 17.5200868751248855
 20.3351711251748313 16.0522900817718082 13.0391624285598979
 21.4211820974406280 16.6019894179828853 12.1810227325608160
 22.1724148098292559 17.6777474539490100 12.5102944850047955
 23.2648911686199895 17.9704035878682902 11.6147941552629455
 23.5465343199822250 17.2297942192681077 10.5140384831779059
 22.7075873869358666 16.0261898343731417 10.0610341860418711
 21.6014107800498039 15.7896608095913180 10.8578889308647906
 21.7084517853362264 18.5894624859543534 13.6744533665058459
 20.4850278823900425 12.5666911895036506 12.7238330249690961
 20.2972728730850065 12.0620915799809296 18.6468328555483076
 11.4783596273673556 12.2463233732241079 12.9650316300890633
 13.3429139265876735 10.7963598121997286 15.6568535544634315
 11.2716541134671999 12.5758430958631777 18.9089901281250441
 18.4295998070645872 10.7619683738163943 15.8916829540149394
 22.5771836552026386 14.8537683498019319 20.0946287936675390
 23.4170105258019881 15.9255488011790725 22.0297869774259425
 15.6609232686877569  9.3317026284603344 20.6048714780061815
 16.8543069798056102 14.3240405074110093  7.4995549533920283
 14.4673082139771090 14.2691513529636609  7.7203545854167848
 17.0341186790684667  8.4773201712662534 11.2232628489408377
 15.1252051300361661  9.2525604031216027  9.9558116105668457
  7.9176358990924482 15.6676648332867252 11.2402503369061737
  8.0410737643027321 13.9972790135088125 15.8803109954453703
 23.4171809778001254 14.7854392741676293 15.5527736718535454
 21.5199825009871546 12.0949336154985190 11.7366538520661674
 21.3261611308672663 11.5565793200760538 19.6919773245656984
 10.3131076599452847 11.9691914757571745 12.1156836502154590
 13.1768387578904793  9.3576417225117936 16.1320747145204066
 10.1414288413085281 12.3116590154576748 19.8391698658527318
 18.6597376783345510  9.4201062468408168 15.2373791068254842
 23.5295916335979172 14.9555362470211435 21.1038286252235068
 16.7977732875321202  8.7857290931695822 21.2013796092883027
 14.4113215729175153  8.8093433351666626 20.8800209635715319
 15.5780493014336017 14.3008209622368554  6.9451520294112887
 17.1084016066252182  7.3346174461493803 10.4428109425493680
 14.0087621943605445 10.2066472480416657  9.6231515172591582
 15.2588277476097982  8.1010527734589957  9.1668447339087891
  6.6422038518091107 14.1069614673663430 16.4313921644004317
 24.7901205668909626 14.4684610170778516 16.2276408958594303
 22.7632591081266611 12.7439807173130006 11.8114935581110849
 21.2939364344483266 11.0831666532244739 10.8007569781964694
 21.3748956112212696 11.9175309461377665 21.0093606878704122
 22.2723401997400430 10.6909183957556628 19.1197437357850184
 10.1957140562040216 12.3516502221581490 10.7843747221976098
  9.2554234637060802 11.3290432973774990 12.7509628528216989
 12.5502587991418793  9.1952121829259212 17.2794968957660586
 13.6531519128245300  8.2130005438430835 15.4561785068104669
  8.9725306935430229 13.0219068820839361 19.6502814411353555
 10.2250591043674994 11.4510202002982062 20.9404055842652710
 19.7367580795854032  9.2914024693457975 14.3955029358039006
 17.8577159538708763  8.3403138560256700 15.5251095104744916
 18.1733141967625365  9.3149949847638389 20.9756141754294134
 16.6083603659484389  7.6643970788619065 22.0178701461225153
 14.2648631475470733  7.7214056277958711 21.7469107445297567
 16.2363990362137613  7.1577839284069178  9.4188256091955953
 25.9854731515790505 14.8332221478728137 15.6191966542269824
 24.8066990000867591 13.7789958102889472 17.4345586419512273
 23.7856619800679780 12.4026794840303118 10.9551850346571449
 22.3944020229465117 10.7409121432132757  9.9711311463841188
 20.0216094392859922 10.3601134076355805 10.6393530801067815
 20.4130192011181109 12.7501712675823278 21.6431411926421760
 22.4247461263801888 11.3495204126684683 21.7446818594937170
 23.2783028891126627 10.1375407234402815 19.9908364541594850
  9.0205353458971125 12.0936365906136523 10.0883139364004109
 11.2657327335143869 13.0403815848353801  9.9989208299622128
  8.0802496474080812 11.0710210260825939 12.0546025584213012
 12.2578671500198588  7.8814352091839055 17.8252542932990394
 14.4643098922845095  8.2794719875886607 14.2280706782539585
 13.3214159718362009  6.9933228138608889 16.0591849800684727
  7.8907038523743172 12.9539998738321991 20.4946214190401292
 11.4198067848839582 10.5584657440698386 21.1779042362728980
  9.0791358355630223 11.3970138695818868 21.8421401109215481
 20.0256344261620747  8.0638265875311319 13.8047374570752801
 16.6849001258830398  8.4208589064345887 16.5094177894729128
 18.1680493938470953  7.1313040478522360 14.8913930416945171
 15.3994208094002154  7.1517768602136762 22.2793167588525876
 25.9367334175710624 15.5619483754857058 14.1762975962163686
 27.1972994179734471 14.5083981098289723 16.2173673019016391
 26.0185227839194440 13.4541738941139108 18.0327203266710043
 23.5841768825017368 11.4054149831922942 10.0563814189946221
 23.3144883774210321 10.5373474434249168 21.2445960517718078
  7.9627384595858279 11.4533760702979208 10.7235755538692903
 12.5807829846610755  6.8595356889465506 17.1951378552095200
  8.0174786790604529 12.1693027390018429 21.5370638303572903
 19.2225318392599789  7.0069707870648621 14.0617024200390475
 27.2140012212258782 13.8188326699509290 17.4242800323212492
 22.3330398462300366 17.5289537609742183 22.6102084054423926
 19.6161017318226882 17.5455026496970419 20.2670885080291896
 19.7585809877173766 17.7186858240732654 21.8516727913425370
 20.6129594733203305 18.6452616391323467 20.8652757706539091
 22.4220607947999540 15.7461537965754399 14.6162165120979655
 20.3922873875201489 13.6229160060424341 21.1979194762253549
 11.4869285529780338 13.8937860652610752 10.4268797040227401
 18.0665896643465835 21.9284343183897867 16.3478431072861916
 19.8560445864534429 21.9872490017431126 17.8759249695617690
 21.1806220403213885 20.0777822341639691 18.1004935176368562
 20.4696276280169478 18.0332738156975978 17.2034699074319732
 16.0084786410983817 20.4429787437291601 15.5245715029733109
 16.7306685844383338 19.3907938505993833 14.5590296119250162
 15.9903111867524537 18.8837381824618333 15.8840655490691276
 13.8421697967581299 14.2264634907466956  9.6361110390445130
 18.3984262073315676 14.3406706063289668 10.3945189447125799
 18.9392012621994184 13.6188267188920911  9.0728101296350339
 18.8261961322377829 15.2142886469706209  9.1239113696914131
 14.4543385179443238 15.1242967506577664 24.6812866092284864
 16.4783898783772713 16.0187014410165318 25.2910668764410076
 18.2427163746328276 16.1563942365844362 23.7684305884305402
 17.9436366574843333 15.2898463387324366 21.6272107156410485
 13.5739598089227904 13.8458898606742089 21.4524401371790461
 13.3484562937788809 13.3906978960182919 22.9701468471057098
 12.9014307306641456 14.8532224752884083 22.4984434605557411
 17.5790082349801544 21.0124562300310558  9.4919211275378323
 15.7194858441146135 22.3358204934857980  9.6305651847296048
 13.9119240953414582 21.6655121817466849 10.9461215427434269
 13.9450350846784570 19.5846095739548716 11.9798033713852821
 18.1054426433222027 17.8666958475718758 11.0489374745688558
 18.3814886595014997 18.5101277918261573  9.6097587359829557
 18.9278478771761378 19.2342320216527298 10.9281112067999313
 14.3850338250031911 11.0804174338979387  9.3878298107630940
 14.7779485043829766 20.7868821410238525 22.7860647015301581
 16.4912111608596135 22.1791233603127793 22.1563781618483020
 18.0681963892140587 21.5482081807502510 20.5591171501324794
 17.8938466764410506 19.4145225923469802 19.6231416719509397
 13.4002197826416722 18.8621254362770117 22.4216868041006379
 13.4158821214141089 18.2417888941731619 20.9464762667091762
 14.2625915685157452 17.5493373822027294 22.1148505841000969
  9.3972933185915117 17.6228555169123595  9.1153968731440465
  7.3568399341929158 16.6579156876382015  9.5628328760603125
 11.5852798398769909 18.0610286561334377  9.5626963881864899
 11.9888560491313676 18.0954751553045270 11.1110281938698598
 12.3866198504516909 16.8353770145921686 10.2082451015268116
 11.4779782395805459 21.5573775003763686 16.6714736015897849
 10.4062536763476849 21.6518987295504246 14.6859301913585298
 10.5686942820514815 19.8668606218028110 13.1876062911308765
 11.8469913950676418 17.9689084833644017 13.7381855548755496
 13.7006256213059761 19.0422467022229185 17.8937633806921284
 13.7324384777030470 20.6393825260710670 17.7983868332721755
 12.4974768362681736 19.9044632846422545 18.5023455553178522
  7.2976232199290099 17.6415683319669299 19.4556902227058153
  7.3051040518757047 16.8441249736834280 21.6187530126462519
  9.1777445628857990 15.7958231884331557 22.4814757002961940
 11.0606456088362659 15.5351620734065321 21.1474234952267253
  8.2082965306036755 17.9237592502257428 17.3660314178263917
  9.7828703876445307 18.2084156241983699 17.3964301788578126
  9.2349064269283989 16.7949534194623098 16.8834605072260828
 23.8154733661650511 18.7207304446428680 11.8057839458571987
 24.3050890004477935 17.4690418539997232  9.9943211834840149
 22.9271759977313963 15.4943427618376006  9.3052440384471389
 20.9574138833457653 15.1392841390270387 10.6031384641875110
 22.3503626376545910 19.3205242620985942 13.7927091086316942
 20.8255217269907043 18.9605227050819032 13.4667293993547510
 21.6560020299329388 18.0641030407295489 14.5000218352413111
  8.8747282969291561 14.9053824355553566 12.8528503130853533
 22.6813263856928913 14.1931607174261920 19.4199216723186154
 24.0608604885585322 15.9926559613398496 22.7250741248201322
 17.6102051762718190 14.3615970637837016  6.9253618553269600
 13.6024161435776563 14.2631101807761596  7.3274500477186972
 17.6569925779703532  8.6077977895848043 11.9287390659706389
  7.0770150662121161 15.2593364152048867 11.4109279509402377
 24.2552372483402046 14.3435441327975965 21.1390212611362642
 13.6425632979082074  9.1939111193733112 20.4757319974926943
 15.4833110218753234 14.3073658451282153  6.0000000000000009
 17.7686648942082819  6.6762276558858282 10.6243295276383805
 13.4951317562215394  9.8570446255189097  8.8653939766992860
 13.4194504111813906 10.3034920036795405 10.4002698700585547
 14.6616897276819795  7.9659667671663605  8.4404285138533783
  6.4564498986612975 15.0396256732600850 16.6677983236297429
  5.9999999999999982 13.8074936277983369 15.7543983758602320
  6.5607237133467038 13.5450313318682198 17.2301389551240050
 22.9002049899711295 13.4252523119190847 12.4594184248786171
 22.2501218281746418 10.4784905154003347 18.1941303941959305
  9.3356221955450245 11.0676886472553839 13.6608086046477819
 12.2800846206756997  9.9644657110196952 17.7672015864338775
  8.9126003258913489 13.5908575573768395 18.8917193859533867
 20.2878372797806144 10.0438047173863794 14.2152815380047297
 18.3923858394176563  9.2594510155468086 20.0219582658870863
 18.2153207105921631 10.2499900243901187 21.2665536126945227
 18.8161247538704970  8.7836401861637121 21.4902219155355745
 17.3708271904718323  7.2492479790348945 22.4034120998604145
 13.4034831314539016  7.3836851652467068 21.9628359111035110
 16.2983562588560034  6.3827011311123982  8.8729085866641793
 23.9898295714740755 13.5297052209406097 17.8504973458263976
 24.6187339383694095 12.8576897222138449 10.9924536024721000
 22.3006860745846396 10.0343042211442288  9.3432418217050852
 19.3110335963479187 10.9957851349464981 10.4129860347172265
 19.7968037645125357  9.9033586195718115 11.4767376617766832
 20.1102245914632007  9.6997417986225081  9.9207320906783458
 20.6547862339803530 12.8701890346407311 22.5854928494753899
 19.5288769759675560 12.3319140744228797 21.5837541634336958
 22.4924519281385784 11.5705002069470382 22.6661127285261443
 23.9019505932014766  9.4981847616547697 19.6671405949767149
  8.9402275253316237 12.3548851967554683  9.1784512044688409
 10.9466494504563467 13.2051589171944208  9.0869338468218057
 12.0645201129147139 12.4734498712908568  9.9679050900351047
  7.3572695548983367 10.6335205305464839 12.4887563713255112
 11.8193654932335530  7.8029510968314320 18.6643463709388584
 14.5851001547300267  9.2162575864850531 13.9668815761312466
 15.3396973246561465  7.8705142875041574 14.3922601800754375
 14.0075380228883972  7.7960037857042757 13.5083609580743129
 13.6366617887362302  6.1987087764225564 15.6443819397638215
  7.0957585299180597 13.4479494838006737 20.3323869846437688
 12.2251386707573939 11.1089231077010240 21.2723562582985863
 11.5282249038145714  9.9486697450725252 20.4186700470161071
 11.2816413068001324 10.0386157019238951 21.9972035449316614
  9.0813763554192377 10.8406312307473769 22.6122174903246318
 20.7759949115587510  7.9704858240928367 13.2296497622234241
 17.0178945639573591  8.6805421327810883 17.3939191181643089
 16.0395513523130191  9.0877262337323437 16.1948591527318193
 16.2478649888276934  7.5457230924893999 16.5692579108172708
 17.6173003255130070  6.3739907949169776 15.0511979492498007
 15.3238366068463492  6.3871285882647939 22.8379762854185273
 26.4022357017463847 16.4226913786910345 14.2290998911629316
 25.0033869426706659 15.7105908251520923 13.9166874521422592
 26.3750438018016204 14.9939817984732731 13.5086984372246590
 28.0142929886672043 14.7575879012243139 15.8014215612389766
 26.0300466058435376 12.9828875341701178 18.8576179942954170
 24.2911297873153096 11.1628773781843620  9.4699733360944371
 24.0138076015579642 10.2228097295039042 21.8055870619206935
  7.1596894239481976 11.2771320961942969 10.2478779890472378
 12.3158820365748163  5.9999999999999964 17.5008070254740105
  7.2842411936208835 12.1422448097196494 22.1406092011449545
 19.4033571012809887  6.1685658603075773 13.6531419415219197
 28.0421612755524947 13.5968211895680504 17.8329262186254134
"""

job_script_knl = """#!/bin/bash

#SBATCH -A m3346
#SBATCH -J Ce3Mn8
#SBATCH -q regular
#SBATCH -C knl 
#SBATCH -N 2
#SBATCH --ntasks-per-node=64
#SBATCH --time=1-00:00:00 
#SBATCH --error=error
#SBATCH --output=output
#SBATCH --mail-type=ALL
#SBATCH --mail-user=shlufl@ufl.edu
##SBATCH --dependency=afterok:45514509
 
module load vasp/6.2.1-knl

export OMP_NUM_THREADS=1

keep_log

srun -n 128 -c 4 --cpu_bind=cores vasp_ncl 
"""

job_script_hybrid = """#!/bin/bash

#SBATCH -A m3346
#SBATCH -J Co3
#SBATCH -q regular
#SBATCH -C knl
#SBATCH -N 4
#SBATCH --ntasks-per-node=8
#SBATCH --time=1-00:00:00
#SBATCH --error=error
#SBATCH --output=output
#SBATCH --mail-type=ALL
#SBATCH --mail-user=shlufl@ufl.edu
##SBATCH --dependency=afterok:45637525

module load vasp/6.1.2-knl

export OMP_NUM_THREADS=8

keep_log

srun -n 32 -c 32 --cpu_bind=cores vasp_ncl
"""

job_script_hipergator = """#!/bin/bash -l

#SBATCH --account=m2qm-efrc
#SBATCH --qos=m2qm-efrc-b
#SBATCH --job-name=Co3
#SBATCH --mail-type=All
#SBATCH --mail-user=shlufl@ufl.edu
#SBATCH --partition=hpg-default
#SBATCH --nodes=1
#SBATCH --ntasks=128
#SBATCH --cpus-per-task=1
#SBATCH --ntasks-per-socket=16
#SBATCH --mem=200gb
#SBATCH --distribution=cyclic:cyclic
#SBATCH -t 96:00:00
#SBATCH --err=error
#SBATCH --output=output
##SBATCH --dependency=afterok:8190473

module purge
module load intel/2020.0.166 openmpi/4.1.1

source ~/.bash_aliases; keep_log

srun --mpi=pmix_v2  $HOME/bin/vasp_ncl
"""

job_script_hpg_gpu = """#!/bin/bash

#SBATCH --job-name=Cr3
#SBATCH --mem-per-cpu=32gb
#SBATCH -t 4-00:00:00
#SBATCH -p gpu --gpus=a100:2
#SBATCH --account=m2qm-efrc
#SBATCH --qos=m2qm-efrc
#SBATCH --nodes=1
#SBATCH --ntasks=2
#SBATCH --ntasks-per-node=2
#SBATCH --mail-type=ALL
#SBATCH --mail-user=shlufl@ufl.edu
#SBATCH --error=error
#SBATCH --output=output
##SBATCH --dependency=afterok:9106099

module purge; module load cuda/11.1.0 nvhpc/20.11 openmpi/4.0.5 qd/2.3.22 fftw/3.3.8 vasp/6.2.0

source ~/.bash_aliases; keep_log

srun --mpi=pmix vasp_ncl
"""

job_script_hpg_gpu = """#!/bin/bash

#SBATCH --job-name=Cr3
#SBATCH --mem-per-cpu=32gb
#SBATCH -t 4-00:00:00
#SBATCH -p gpu --gpus=a100:2
#SBATCH --account=m2qm-efrc
#SBATCH --qos=m2qm-efrc
#SBATCH --nodes=1
#SBATCH --ntasks=2
#SBATCH --ntasks-per-node=2
#SBATCH --mail-type=ALL
#SBATCH --mail-user=shlufl@ufl.edu
#SBATCH --error=error
#SBATCH --output=output
##SBATCH --dependency=afterok:9106099

module purge; module load cuda/11.1.0 nvhpc/20.11 qd/2.3.22 openmpi/4.0.5 fftw/3.3.8

export LD_LIBRARY_PATH=/apps/nvidia/nvhpc/Linux_x86_64/20.11/compilers/extras/qd/lib:$LD_LIBRARY_PATH

source ~/.bash_aliases; keep_log

srun --mpi=pmix /home/shlufl/apps/vasp.6.2.1/bin_gpu/vasp_ncl
"""

job_script_perlmutter_1_node = """#!/bin/bash
#SBATCH -A m3346_g
#SBATCH -J FePc
#SBATCH -C gpu
#SBATCH -q regular
#SBATCH -t 6:00:00
#SBATCH -n 4
#SBATCH --ntasks-per-node=4
#SBATCH -c 32
#SBATCH --gpus-per-task=1
#SBATCH --error=error
#SBATCH --output=output
#SBATCH --mail-type=ALL
#SBATCH --mail-user=shlufl@ufl.edu
##SBATCH --dependency=afterok:45514509

module load vasp/6.2.1-gpu

export OMP_NUM_THREADS=1
export SLURM_CPU_BIND="cores"

source ~/.bash_aliases; keep_log

#if [ -f CONTCAR ]; then nl=$(wc -l CONTCAR | awk '{printf "%d", $1}'); if [ $nl -gt 8 ]; then cp CONTCAR POSCAR; else echo "Incomplete CONTCAR"; exit; fi; fi
#if [ -f STOPCAR ]; then rm STOPCAR; fi

srun -n 4 vasp_ncl
"""

job_script_perlmutter_4_nodes = """#!/bin/bash

#SBATCH -A m3346_g
#SBATCH -J Ce3
#SBATCH -C gpu
#SBATCH -q regular
#SBATCH -t 01:30:00
#SBATCH -N 4
#SBATCH -n 16
#SBATCH -G 16
#SBATCH -c 32
#SBATCH --gpus-per-task=1
#SBATCH --error=error
#SBATCH --output=output
#SBATCH --mail-type=ALL
#SBATCH --mail-user=shlufl@ufl.edu
##SBATCH --dependency=afterok:45514509

module load vasp/6.2.1-gpu

source ~/.bash_aliases; keep_log

srun -n 16 -c 32 --cpu-bind=cores -G 16 --gpu-bind=single:1 vasp_ncl
"""

job_script = job_script_perlmutter_4_nodes

emats_file = []

for i in range(100):
    emats_file.append( [[1,0,0],[0,1,0],[0,0,1]] )

